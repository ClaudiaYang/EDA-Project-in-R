---
title: "EDA Code Notebook Draft"
author: "Group 5"
date: "2024-10-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

Introduction
This dataset focuses on school performances scores across various U.S. states from 2005 to 2015. This dataset provides us with potential insights on understanding the educational landscape in the United States. It includes some interesting variables such as graduation rates, test scores, teacher statistics, student-teacher ratios, gender ratios, family income and many other factors that could impact the school performance (measured by GPA).

This analysis is motivated by a need to investigate the disparities and inequalities in educational outcomes across different regions and demographics. Through exploring the potential relationships between variables mentioned above, we want to discover some pattern that might highlight areas in need of education policy intervention. By evaluating the extent to which these resources correlate with studentsâ€™ academic success, the educational stakeholders could also gain some data-driven insights for improving public education. 

We chose this dataset because we are fully aware that education is the foundation of personal and societal progress as college students. Many of the issues college students face, like unequal access to quality education, educational funding, and achievement gaps, begin in the K-12 system. This dataset also fits into our academic interests. Because it offers a unique opportunity to combine our data analytical skills and interest in social sciences. 

```{r}
#Load the dataset
score<-read.csv("data/school_scores.csv")
```

```{r, echo=false}
#Inspect the dataset
head(score)
```

Data Cleaning/Simplifying

It is shown that there are 99 variables total in this dataset, which is too many for our analysis. After careful examination of the dataset, we decided to subset the dataset with the variables we think that are useful for our analysis. 
```{r}
# Subset the dataset with relevant variables 
demographic_vars <- c("Year", "State.Code", "State.Name")
test_score_vars <- c("Total.Math", "Total.Test.takers", "Total.Verbal", 
                     "Family.Income.Between.20.40k.Math", "GPA.A.Math", 
                     "Gender.Female.Math", "Score.Ranges.Between.300.to.400.Math.Total")
academic_vars <- c("Academic.Subjects.Arts.Music.Average.GPA", 
                   "Academic.Subjects.English.Average.GPA",
                   "Academic.Subjects.Mathematics.Average.GPA", 
                   "Academic.Subjects.Natural.Sciences.Average.Years")
income_vars <- grep("Family.Income", colnames(score), value = TRUE)
gpa_vars <- grep("GPA", colnames(score), value = TRUE)
```

```{r}
# Combine all selected variables into one vector
selected_vars <- c(demographic_vars, test_score_vars, academic_vars, income_vars, gpa_vars)
```

```{r}
# Subset the dataset
score_subset <- score %>%
  select(all_of(selected_vars))
```

```{r}
# Check the structure of the new subset
str(score_subset)
head(score_subset)
```

```{r}
#Summary Statistics of the dataset
summary(score_subset)
```


```{r}
#save the new subset to a file
write_csv(score_subset, "data/school_scores_subset.csv")
```
By the code above, we reduced the variables from 99 to 54, leaving the ones we think are potentially insightful only. 


Part I: Describing and Breaking down Variables

In the dataset subseting section, we have catgetorized the 54 variables into four themes. We would now explore the four themes separately. 

Theme 1: Demographic information
The dataset contains basic demographic information that helps identify the year and the state in which the data was collected. These variables include:
Year: The year the data was recorded.
State.Code: Numeric or alphabetical codes assigned to states.
State.Name: The full names of the states.

```{r}
demographic_vars <- c("Year", "State.Code", "State.Name")
demographic_data <- score_subset[, demographic_vars]
print(demographic_data)
```

Theme 2: Test Scores
Test scores represent one of the core components of our dataset. These variables include overall test scores, family income group test scores, and test scores based on GPA. Here are the main variables:

Overall Test Scores: Total.Math, Total.Test.takers, Total.Verbal
Family Income Brackets: Family.Income.Between.20.40k.Math, Family.Income.More.than.100k.Verbal
GPA Test Scores: GPA.A.Math, GPA.C.Verbal, GPA.No.response.Math
Gender-based Test Scores: Gender.Female.Math, Gender.Male.Verbal
Score Ranges: These show performance in specific score ranges, such as Score.Ranges.Between.300.to.400.Math.Total.

```{r}
test_score_vars <- c("Total.Math", "Total.Test.takers", "Total.Verbal", 
                     "Family.Income.Between.20.40k.Math", "GPA.A.Math", 
                     "Gender.Female.Math", "Score.Ranges.Between.300.to.400.Math.Total")
test_score_data <- score_subset[, test_score_vars]
print(test_score_data)
```

Theme 3: Academic Performance in Subjects
Our dataset also provides information on GPA and the number of years spent studying different subjects. The subjects include arts, English, foreign languages, mathematics, and natural sciences. Each subject has two variables:

Average GPA: For example, Academic.Subjects.English.Average.GPA.
Average Years of Study: For example, Academic.Subjects.English.Average.Years.
R Code to display Academic Performance Variables

```{r}
academic_vars <- c("Academic.Subjects.Arts.Music.Average.GPA", 
                   "Academic.Subjects.English.Average.GPA",
                   "Academic.Subjects.Mathematics.Average.GPA", 
                   "Academic.Subjects.Natural.Sciences.Average.Years")
academic_data <- score_subset[, academic_vars]
print(academic_data)
```

Theme 4. Family Income Groups
Family income groups are crucial in understanding how socioeconomic factors influence student performance. Our dataset includes variables for different income brackets and their corresponding test scores:

Family.Income.Between.20.40k.Math
Family.Income.More.than.100k.Verbal
Family.Income.Less.than.20k.Test.takers

```{r}
income_vars <- grep("Family.Income", colnames(score), value = TRUE)
income_data <- score_subset[, income_vars]
print(income_data)
```

Theme 5: GPA-based Breakdown
Our dataset provides a breakdown of test scores based on GPA ranges. Students are categorized into groups based on their GPA, ranging from A+ to D or lower. This allows for analysis of how students in different GPA ranges perform on standardized tests:

GPA.A.Math
GPA.B.Verbal
GPA.D.or.lower.Math

```{r}
gpa_vars <- grep("GPA", colnames(score), value = TRUE)
gpa_data <- score_subset[, gpa_vars]
print(gpa_data)
```


Part II: Some Simple Analysis and Visualizations

Visualization

We calculated the mean math score for each GPA category and plotted it in a bar plot. This visualization shows how math scores are distributed across GPA categories, with each bar representing the average math score for a specific GPA range (from "A+" to "D or lower"). 

```{r}
gpa_math_data <- data.frame(
  GPA = c("A+", "A", "A-", "B", "C", "D or lower"),
  Math_Scores = c(mean(score_subset$GPA.A.plus.Math, na.rm = TRUE), 
                  mean(score_subset$GPA.A.Math, na.rm = TRUE), 
                  mean(score_subset$GPA.A.minus.Math, na.rm = TRUE),
                  mean(score_subset$GPA.B.Math, na.rm = TRUE),
                  mean(score_subset$GPA.C.Math, na.rm = TRUE),
                  mean(score_subset$GPA.D.or.lower.Math, na.rm = TRUE))
)

barplot(gpa_math_data$Math_Scores, 
        names.arg = gpa_math_data$GPA, 
        main = "Average Math Scores by GPA Category", 
        xlab = "GPA Category", 
        ylab = "Math Scores")
```

We can observe a decreasing trend in the plot, indicating an association between GPA and math scores. 
The students with an "A+" GPA have the highest average math scores, while those in the "D or lower" category have the lowest. This suggests that students with higher GPAs tend to perform better in SAT math, and there's a consistent drop in math scores as GPA decreases. 




```{r}
income_takers <- c(sum(score_subset$Family.Income.Less.than.20k.Test.takers, na.rm = TRUE),
                   sum(score_subset$Family.Income.Between.20.40k.Test.takers, na.rm = TRUE),
                   sum(score_subset$Family.Income.Between.40.60k.Test.takers, na.rm = TRUE),
                   sum(score_subset$Family.Income.More.than.100k.Test.takers, na.rm = TRUE))

income_labels <- c("Less than 20k", "Between 20-40k", "Between 40-60k", "More than 100k")

pie(income_takers, labels = income_labels, 
    main = "Test Takers by Family Income Group")
```



```{r}
#Average verbal scores across different GPA categories
gpa_verbal_data <- data.frame(
  GPA = c("A+", "A", "A-", "B", "C", "D or lower"),
  Verbal_Scores = c(mean(score_subset$GPA.A.plus.Verbal, na.rm = TRUE), 
                    mean(score_subset$GPA.A.Verbal, na.rm = TRUE), 
                    mean(score_subset$GPA.A.minus.Verbal, na.rm = TRUE),
                    mean(score_subset$GPA.B.Verbal, na.rm = TRUE),
                    mean(score_subset$GPA.C.Verbal, na.rm = TRUE),
                    mean(score_subset$GPA.D.or.lower.Verbal, na.rm = TRUE))
)

barplot(gpa_verbal_data$Verbal_Scores, 
        names.arg = gpa_verbal_data$GPA, 
        main = "Average Verbal Scores by GPA Category", 
        xlab = "GPA Category", 
        ylab = "Verbal Scores", 
        col = "lightblue")


```


Boxplot of Math Scores by Family Income Bracket
```{r}
income_math_data <- score[, c("Family.Income.Less.than.20k.Math", 
                              "Family.Income.Between.20.40k.Math",
                              "Family.Income.Between.40.60k.Math",
                              "Family.Income.More.than.100k.Math")]

colnames(income_math_data) <- c("<20k", "20-40k", "40-60k", ">100k")

boxplot(income_math_data, 
        main = "Distribution of Math Scores by Family Income Bracket", 
        xlab = "Family Income Bracket", 
        ylab = "Math Scores", 
        col = c("lightgreen", "lightblue", "lightcoral", "lightgoldenrod"))
```
Histogram of Total Math Scores
```{r}
hist(score$Total.Math, 
     breaks = 20, 
     main = "Histogram of Total Math Scores", 
     xlab = "Math Scores", 
     col = "lightcoral", 
     border = "black")
```
Math Scores vs. Verbal Scores
```{r}
plot(score$Total.Math, score$Total.Verbal, 
     main = "Math Scores vs. Verbal Scores", 
     xlab = "Math Scores", 
     ylab = "Verbal Scores", 
     pch = 19, 
     col = "blue")
```
Gender Breakdown of Test Takers
```{r}
gender_takers <- c(sum(score$Gender.Female.Test.takers, na.rm = TRUE), 
                   sum(score$Gender.Male.Test.takers, na.rm = TRUE))

gender_labels <- c("Female", "Male")

pie(gender_takers, labels = gender_labels, 
    main = "Test Takers by Gender", 
    col = c("pink", "lightblue"))
```
Average Math Scores by Gender
```{r}
gender_math_avg <- c(mean(score_subset$Gender.Female.Math, na.rm = TRUE), 
                     mean(score_subset$Gender.Male.Math, na.rm = TRUE))

barplot(gender_math_avg, 
        names.arg = c("Female", "Male"), 
        main = "Average Math Scores by Gender", 
        xlab = "Gender", 
        ylab = "Average Math Scores", 
        col = c("pink", "lightblue"))
```

```{r}
score_numeric <- score_subset[, c("Total.Math", "Total.Verbal", "Family.Income.Between.20.40k.Math", 
                           "Family.Income.Between.20.40k.Verbal")]

cor_matrix <- cor(score_numeric, use = "complete.obs")

heatmap(cor_matrix, 
        main = "Correlation Heatmap of Scores", 
        col = heat.colors(256), 
        symm = TRUE)
```

